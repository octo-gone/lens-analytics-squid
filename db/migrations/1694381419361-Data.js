module.exports = class Data1694381419361 {
    name = 'Data1694381419361'

    async up(db) {
        await db.query(`CREATE TABLE "post" ("id" character varying NOT NULL, "content_uri" text NOT NULL, "content" jsonb, CONSTRAINT "PK_be5fda3aac270b134ff9c21cdee" PRIMARY KEY ("id"))`)
        await db.query(`CREATE TABLE "mirror" ("id" character varying NOT NULL, "mirrored_creator_id" character varying, "mirrored_publication_id" character varying, CONSTRAINT "PK_1550eca1496157edb9af20a1bdd" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_bd7df2937349fcbce9ec792ada" ON "mirror" ("mirrored_creator_id") `)
        await db.query(`CREATE INDEX "IDX_e4d9ffc54c3594135f98ee4c19" ON "mirror" ("mirrored_publication_id") `)
        await db.query(`CREATE TABLE "comment" ("id" character varying NOT NULL, "content_uri" text NOT NULL, "content" jsonb, "commented_creator_id" character varying, "commented_publication_id" character varying, CONSTRAINT "PK_0b0e4bbc8415ec426f87f3a88e2" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_1d9ca0edf55bf20f432c833f05" ON "comment" ("commented_creator_id") `)
        await db.query(`CREATE INDEX "IDX_c347365e78bd7ea7084bb871d1" ON "comment" ("commented_publication_id") `)
        await db.query(`CREATE TABLE "publication_ref" ("id" character varying NOT NULL, "variant" character varying(7) NOT NULL, "timestamp" TIMESTAMP WITH TIME ZONE NOT NULL, "creator_id" character varying, "post_id" character varying, "mirror_id" character varying, "comment_id" character varying, CONSTRAINT "REL_baab7ed927f6da2aec78efaacf" UNIQUE ("post_id"), CONSTRAINT "REL_a3f289268936a82b5754ff8c5d" UNIQUE ("mirror_id"), CONSTRAINT "REL_855d700f25c5a1da322a4d18b0" UNIQUE ("comment_id"), CONSTRAINT "PK_e1ca18ac7ada3c0d380b133c0b4" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_adeed6d2bc6d6c6b21571cc43a" ON "publication_ref" ("creator_id") `)
        await db.query(`CREATE INDEX "IDX_e4766abf51475ccd0402dc5fb5" ON "publication_ref" ("variant") `)
        await db.query(`CREATE UNIQUE INDEX "IDX_baab7ed927f6da2aec78efaacf" ON "publication_ref" ("post_id") `)
        await db.query(`CREATE UNIQUE INDEX "IDX_a3f289268936a82b5754ff8c5d" ON "publication_ref" ("mirror_id") `)
        await db.query(`CREATE UNIQUE INDEX "IDX_855d700f25c5a1da322a4d18b0" ON "publication_ref" ("comment_id") `)
        await db.query(`CREATE INDEX "IDX_60d7c3c21224310ff3d5cde331" ON "publication_ref" ("timestamp") `)
        await db.query(`CREATE TABLE "profile" ("id" character varying NOT NULL, "address" text NOT NULL, "handle" text NOT NULL, "image_uri" text NOT NULL, "created_at" TIMESTAMP WITH TIME ZONE NOT NULL, "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL, CONSTRAINT "PK_3dd8bfc97e4a77c70971591bdcb" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_486591528fda0f35f22560c47f" ON "profile" ("address") `)
        await db.query(`CREATE INDEX "IDX_e1eea55c5dc00feee13279e4cc" ON "profile" ("handle") `)
        await db.query(`CREATE INDEX "IDX_0ed669a723a2a49942d30301a0" ON "profile" ("created_at") `)
        await db.query(`CREATE INDEX "IDX_1ba9ea99166dd36c702f512930" ON "profile" ("updated_at") `)
        await db.query(`ALTER TABLE "mirror" ADD CONSTRAINT "FK_bd7df2937349fcbce9ec792ada1" FOREIGN KEY ("mirrored_creator_id") REFERENCES "profile"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "mirror" ADD CONSTRAINT "FK_e4d9ffc54c3594135f98ee4c19d" FOREIGN KEY ("mirrored_publication_id") REFERENCES "publication_ref"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "comment" ADD CONSTRAINT "FK_1d9ca0edf55bf20f432c833f056" FOREIGN KEY ("commented_creator_id") REFERENCES "profile"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "comment" ADD CONSTRAINT "FK_c347365e78bd7ea7084bb871d1f" FOREIGN KEY ("commented_publication_id") REFERENCES "publication_ref"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "publication_ref" ADD CONSTRAINT "FK_adeed6d2bc6d6c6b21571cc43af" FOREIGN KEY ("creator_id") REFERENCES "profile"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "publication_ref" ADD CONSTRAINT "FK_baab7ed927f6da2aec78efaacf8" FOREIGN KEY ("post_id") REFERENCES "post"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "publication_ref" ADD CONSTRAINT "FK_a3f289268936a82b5754ff8c5db" FOREIGN KEY ("mirror_id") REFERENCES "mirror"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "publication_ref" ADD CONSTRAINT "FK_855d700f25c5a1da322a4d18b07" FOREIGN KEY ("comment_id") REFERENCES "comment"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    }

    async down(db) {
        await db.query(`DROP TABLE "post"`)
        await db.query(`DROP TABLE "mirror"`)
        await db.query(`DROP INDEX "public"."IDX_bd7df2937349fcbce9ec792ada"`)
        await db.query(`DROP INDEX "public"."IDX_e4d9ffc54c3594135f98ee4c19"`)
        await db.query(`DROP TABLE "comment"`)
        await db.query(`DROP INDEX "public"."IDX_1d9ca0edf55bf20f432c833f05"`)
        await db.query(`DROP INDEX "public"."IDX_c347365e78bd7ea7084bb871d1"`)
        await db.query(`DROP TABLE "publication_ref"`)
        await db.query(`DROP INDEX "public"."IDX_adeed6d2bc6d6c6b21571cc43a"`)
        await db.query(`DROP INDEX "public"."IDX_e4766abf51475ccd0402dc5fb5"`)
        await db.query(`DROP INDEX "public"."IDX_baab7ed927f6da2aec78efaacf"`)
        await db.query(`DROP INDEX "public"."IDX_a3f289268936a82b5754ff8c5d"`)
        await db.query(`DROP INDEX "public"."IDX_855d700f25c5a1da322a4d18b0"`)
        await db.query(`DROP INDEX "public"."IDX_60d7c3c21224310ff3d5cde331"`)
        await db.query(`DROP TABLE "profile"`)
        await db.query(`DROP INDEX "public"."IDX_486591528fda0f35f22560c47f"`)
        await db.query(`DROP INDEX "public"."IDX_e1eea55c5dc00feee13279e4cc"`)
        await db.query(`DROP INDEX "public"."IDX_0ed669a723a2a49942d30301a0"`)
        await db.query(`DROP INDEX "public"."IDX_1ba9ea99166dd36c702f512930"`)
        await db.query(`ALTER TABLE "mirror" DROP CONSTRAINT "FK_bd7df2937349fcbce9ec792ada1"`)
        await db.query(`ALTER TABLE "mirror" DROP CONSTRAINT "FK_e4d9ffc54c3594135f98ee4c19d"`)
        await db.query(`ALTER TABLE "comment" DROP CONSTRAINT "FK_1d9ca0edf55bf20f432c833f056"`)
        await db.query(`ALTER TABLE "comment" DROP CONSTRAINT "FK_c347365e78bd7ea7084bb871d1f"`)
        await db.query(`ALTER TABLE "publication_ref" DROP CONSTRAINT "FK_adeed6d2bc6d6c6b21571cc43af"`)
        await db.query(`ALTER TABLE "publication_ref" DROP CONSTRAINT "FK_baab7ed927f6da2aec78efaacf8"`)
        await db.query(`ALTER TABLE "publication_ref" DROP CONSTRAINT "FK_a3f289268936a82b5754ff8c5db"`)
        await db.query(`ALTER TABLE "publication_ref" DROP CONSTRAINT "FK_855d700f25c5a1da322a4d18b07"`)
    }
}
