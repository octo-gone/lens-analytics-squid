module.exports = class Data1694941385245 {
    name = 'Data1694941385245'

    async up(db) {
        await db.query(`CREATE TABLE "post" ("id" character varying NOT NULL, "content_uri" text NOT NULL, "content" jsonb, CONSTRAINT "PK_be5fda3aac270b134ff9c21cdee" PRIMARY KEY ("id"))`)
        await db.query(`CREATE TABLE "mirror" ("id" character varying NOT NULL, "mirrored_creator_id" character varying, "mirrored_publication_id" character varying, CONSTRAINT "PK_1550eca1496157edb9af20a1bdd" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_bd7df2937349fcbce9ec792ada" ON "mirror" ("mirrored_creator_id") `)
        await db.query(`CREATE INDEX "IDX_e4d9ffc54c3594135f98ee4c19" ON "mirror" ("mirrored_publication_id") `)
        await db.query(`CREATE TABLE "comment" ("id" character varying NOT NULL, "content_uri" text NOT NULL, "content" jsonb, "commented_creator_id" character varying, "commented_publication_id" character varying, CONSTRAINT "PK_0b0e4bbc8415ec426f87f3a88e2" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_1d9ca0edf55bf20f432c833f05" ON "comment" ("commented_creator_id") `)
        await db.query(`CREATE INDEX "IDX_c347365e78bd7ea7084bb871d1" ON "comment" ("commented_publication_id") `)
        await db.query(`CREATE TABLE "collect" ("id" character varying NOT NULL, "nft_owner_address" text NOT NULL, "tx_hash" text NOT NULL, "timestamp" TIMESTAMP WITH TIME ZONE NOT NULL, "collector_id" character varying, "collected_creator_id" character varying, "collected_publication_id" character varying, "collected_root_creator_id" character varying, "collected_root_publication_id" character varying, CONSTRAINT "PK_48dc0a6d1738eb0ee8f1e13d3d1" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_e5eb8798c52c2014c6241e0726" ON "collect" ("nft_owner_address") `)
        await db.query(`CREATE INDEX "IDX_085b3bf104033de7d1471f1f4f" ON "collect" ("collector_id") `)
        await db.query(`CREATE INDEX "IDX_52faaf00229800a6a8aafe4fa1" ON "collect" ("collected_creator_id") `)
        await db.query(`CREATE INDEX "IDX_dc6686a309914a5b8da07752e1" ON "collect" ("collected_publication_id") `)
        await db.query(`CREATE INDEX "IDX_f538104b0af9bf33281844848a" ON "collect" ("collected_root_creator_id") `)
        await db.query(`CREATE INDEX "IDX_21897f95882fddfc8b58321f99" ON "collect" ("collected_root_publication_id") `)
        await db.query(`CREATE INDEX "IDX_a2fa1b38a2c0dfd9daa5d41d45" ON "collect" ("tx_hash") `)
        await db.query(`CREATE INDEX "IDX_20e5bbb99bd24bead8e90c1814" ON "collect" ("timestamp") `)
        await db.query(`CREATE TABLE "publication_ref" ("id" character varying NOT NULL, "variant" character varying(7) NOT NULL, "tx_hash" text NOT NULL, "timestamp" TIMESTAMP WITH TIME ZONE NOT NULL, "creator_id" character varying, "post_id" character varying, "mirror_id" character varying, "comment_id" character varying, CONSTRAINT "REL_baab7ed927f6da2aec78efaacf" UNIQUE ("post_id"), CONSTRAINT "REL_a3f289268936a82b5754ff8c5d" UNIQUE ("mirror_id"), CONSTRAINT "REL_855d700f25c5a1da322a4d18b0" UNIQUE ("comment_id"), CONSTRAINT "PK_e1ca18ac7ada3c0d380b133c0b4" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_adeed6d2bc6d6c6b21571cc43a" ON "publication_ref" ("creator_id") `)
        await db.query(`CREATE INDEX "IDX_e4766abf51475ccd0402dc5fb5" ON "publication_ref" ("variant") `)
        await db.query(`CREATE UNIQUE INDEX "IDX_baab7ed927f6da2aec78efaacf" ON "publication_ref" ("post_id") `)
        await db.query(`CREATE UNIQUE INDEX "IDX_a3f289268936a82b5754ff8c5d" ON "publication_ref" ("mirror_id") `)
        await db.query(`CREATE UNIQUE INDEX "IDX_855d700f25c5a1da322a4d18b0" ON "publication_ref" ("comment_id") `)
        await db.query(`CREATE INDEX "IDX_16b5fb1f5422610df5c65d37aa" ON "publication_ref" ("tx_hash") `)
        await db.query(`CREATE INDEX "IDX_60d7c3c21224310ff3d5cde331" ON "publication_ref" ("timestamp") `)
        await db.query(`CREATE TABLE "profile" ("id" character varying NOT NULL, "address" text NOT NULL, "handle" text NOT NULL, "image_uri" text NOT NULL, "created_at" TIMESTAMP WITH TIME ZONE NOT NULL, "updated_at" TIMESTAMP WITH TIME ZONE NOT NULL, CONSTRAINT "PK_3dd8bfc97e4a77c70971591bdcb" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_486591528fda0f35f22560c47f" ON "profile" ("address") `)
        await db.query(`CREATE INDEX "IDX_e1eea55c5dc00feee13279e4cc" ON "profile" ("handle") `)
        await db.query(`CREATE INDEX "IDX_0ed669a723a2a49942d30301a0" ON "profile" ("created_at") `)
        await db.query(`CREATE INDEX "IDX_1ba9ea99166dd36c702f512930" ON "profile" ("updated_at") `)
        await db.query(`CREATE TABLE "follow" ("id" character varying NOT NULL, "nft_owner_address" text NOT NULL, "profile_ids" text array, "follow_module_datas" text array, "tx_hash" text NOT NULL, "timestamp" TIMESTAMP WITH TIME ZONE NOT NULL, CONSTRAINT "PK_fda88bc28a84d2d6d06e19df6e5" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_673fb43a6901c97ebcb0b6b8b1" ON "follow" ("nft_owner_address") `)
        await db.query(`CREATE INDEX "IDX_7ffde482fe3e5fac567d7997e4" ON "follow" ("tx_hash") `)
        await db.query(`CREATE INDEX "IDX_691a2347f6876e8b22cda3017e" ON "follow" ("timestamp") `)
        await db.query(`CREATE TABLE "profile_transfer" ("id" character varying NOT NULL, "from" text NOT NULL, "to" text NOT NULL, "tx_hash" text NOT NULL, "timestamp" TIMESTAMP WITH TIME ZONE NOT NULL, "profile_id" character varying, CONSTRAINT "PK_70481bd2e9a26dcaac487ccc951" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_f94f6fa6fcd222a95d91ec103d" ON "profile_transfer" ("from") `)
        await db.query(`CREATE INDEX "IDX_bd22eb5b4826600dd121b6e606" ON "profile_transfer" ("to") `)
        await db.query(`CREATE INDEX "IDX_30baa7f52c2e661f4ca493ab45" ON "profile_transfer" ("profile_id") `)
        await db.query(`CREATE INDEX "IDX_479444245575c827fc7dbaf9c9" ON "profile_transfer" ("tx_hash") `)
        await db.query(`CREATE INDEX "IDX_532de2437e9df87a4922597df0" ON "profile_transfer" ("timestamp") `)
        await db.query(`CREATE TABLE "profile_image_update" ("id" character varying NOT NULL, "old_image_uri" text NOT NULL, "new_image_uri" text NOT NULL, "tx_hash" text NOT NULL, "timestamp" TIMESTAMP WITH TIME ZONE NOT NULL, "profile_id" character varying, CONSTRAINT "PK_6749026a986f134e4f1134fa3f9" PRIMARY KEY ("id"))`)
        await db.query(`CREATE INDEX "IDX_3b7c467f695dc8f3ec760ee85e" ON "profile_image_update" ("profile_id") `)
        await db.query(`CREATE INDEX "IDX_219c6c21f1a76f819363387882" ON "profile_image_update" ("tx_hash") `)
        await db.query(`CREATE INDEX "IDX_0b771344d869d543e7bb75d945" ON "profile_image_update" ("timestamp") `)
        await db.query(`ALTER TABLE "mirror" ADD CONSTRAINT "FK_bd7df2937349fcbce9ec792ada1" FOREIGN KEY ("mirrored_creator_id") REFERENCES "profile"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "mirror" ADD CONSTRAINT "FK_e4d9ffc54c3594135f98ee4c19d" FOREIGN KEY ("mirrored_publication_id") REFERENCES "publication_ref"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "comment" ADD CONSTRAINT "FK_1d9ca0edf55bf20f432c833f056" FOREIGN KEY ("commented_creator_id") REFERENCES "profile"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "comment" ADD CONSTRAINT "FK_c347365e78bd7ea7084bb871d1f" FOREIGN KEY ("commented_publication_id") REFERENCES "publication_ref"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "collect" ADD CONSTRAINT "FK_085b3bf104033de7d1471f1f4f5" FOREIGN KEY ("collector_id") REFERENCES "profile"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "collect" ADD CONSTRAINT "FK_52faaf00229800a6a8aafe4fa1a" FOREIGN KEY ("collected_creator_id") REFERENCES "profile"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "collect" ADD CONSTRAINT "FK_dc6686a309914a5b8da07752e1f" FOREIGN KEY ("collected_publication_id") REFERENCES "publication_ref"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "collect" ADD CONSTRAINT "FK_f538104b0af9bf33281844848a1" FOREIGN KEY ("collected_root_creator_id") REFERENCES "profile"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "collect" ADD CONSTRAINT "FK_21897f95882fddfc8b58321f99b" FOREIGN KEY ("collected_root_publication_id") REFERENCES "publication_ref"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "publication_ref" ADD CONSTRAINT "FK_adeed6d2bc6d6c6b21571cc43af" FOREIGN KEY ("creator_id") REFERENCES "profile"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "publication_ref" ADD CONSTRAINT "FK_baab7ed927f6da2aec78efaacf8" FOREIGN KEY ("post_id") REFERENCES "post"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "publication_ref" ADD CONSTRAINT "FK_a3f289268936a82b5754ff8c5db" FOREIGN KEY ("mirror_id") REFERENCES "mirror"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "publication_ref" ADD CONSTRAINT "FK_855d700f25c5a1da322a4d18b07" FOREIGN KEY ("comment_id") REFERENCES "comment"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "profile_transfer" ADD CONSTRAINT "FK_30baa7f52c2e661f4ca493ab45e" FOREIGN KEY ("profile_id") REFERENCES "profile"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
        await db.query(`ALTER TABLE "profile_image_update" ADD CONSTRAINT "FK_3b7c467f695dc8f3ec760ee85e9" FOREIGN KEY ("profile_id") REFERENCES "profile"("id") ON DELETE NO ACTION ON UPDATE NO ACTION`)
    }

    async down(db) {
        await db.query(`DROP TABLE "post"`)
        await db.query(`DROP TABLE "mirror"`)
        await db.query(`DROP INDEX "public"."IDX_bd7df2937349fcbce9ec792ada"`)
        await db.query(`DROP INDEX "public"."IDX_e4d9ffc54c3594135f98ee4c19"`)
        await db.query(`DROP TABLE "comment"`)
        await db.query(`DROP INDEX "public"."IDX_1d9ca0edf55bf20f432c833f05"`)
        await db.query(`DROP INDEX "public"."IDX_c347365e78bd7ea7084bb871d1"`)
        await db.query(`DROP TABLE "collect"`)
        await db.query(`DROP INDEX "public"."IDX_e5eb8798c52c2014c6241e0726"`)
        await db.query(`DROP INDEX "public"."IDX_085b3bf104033de7d1471f1f4f"`)
        await db.query(`DROP INDEX "public"."IDX_52faaf00229800a6a8aafe4fa1"`)
        await db.query(`DROP INDEX "public"."IDX_dc6686a309914a5b8da07752e1"`)
        await db.query(`DROP INDEX "public"."IDX_f538104b0af9bf33281844848a"`)
        await db.query(`DROP INDEX "public"."IDX_21897f95882fddfc8b58321f99"`)
        await db.query(`DROP INDEX "public"."IDX_a2fa1b38a2c0dfd9daa5d41d45"`)
        await db.query(`DROP INDEX "public"."IDX_20e5bbb99bd24bead8e90c1814"`)
        await db.query(`DROP TABLE "publication_ref"`)
        await db.query(`DROP INDEX "public"."IDX_adeed6d2bc6d6c6b21571cc43a"`)
        await db.query(`DROP INDEX "public"."IDX_e4766abf51475ccd0402dc5fb5"`)
        await db.query(`DROP INDEX "public"."IDX_baab7ed927f6da2aec78efaacf"`)
        await db.query(`DROP INDEX "public"."IDX_a3f289268936a82b5754ff8c5d"`)
        await db.query(`DROP INDEX "public"."IDX_855d700f25c5a1da322a4d18b0"`)
        await db.query(`DROP INDEX "public"."IDX_16b5fb1f5422610df5c65d37aa"`)
        await db.query(`DROP INDEX "public"."IDX_60d7c3c21224310ff3d5cde331"`)
        await db.query(`DROP TABLE "profile"`)
        await db.query(`DROP INDEX "public"."IDX_486591528fda0f35f22560c47f"`)
        await db.query(`DROP INDEX "public"."IDX_e1eea55c5dc00feee13279e4cc"`)
        await db.query(`DROP INDEX "public"."IDX_0ed669a723a2a49942d30301a0"`)
        await db.query(`DROP INDEX "public"."IDX_1ba9ea99166dd36c702f512930"`)
        await db.query(`DROP TABLE "follow"`)
        await db.query(`DROP INDEX "public"."IDX_673fb43a6901c97ebcb0b6b8b1"`)
        await db.query(`DROP INDEX "public"."IDX_7ffde482fe3e5fac567d7997e4"`)
        await db.query(`DROP INDEX "public"."IDX_691a2347f6876e8b22cda3017e"`)
        await db.query(`DROP TABLE "profile_transfer"`)
        await db.query(`DROP INDEX "public"."IDX_f94f6fa6fcd222a95d91ec103d"`)
        await db.query(`DROP INDEX "public"."IDX_bd22eb5b4826600dd121b6e606"`)
        await db.query(`DROP INDEX "public"."IDX_30baa7f52c2e661f4ca493ab45"`)
        await db.query(`DROP INDEX "public"."IDX_479444245575c827fc7dbaf9c9"`)
        await db.query(`DROP INDEX "public"."IDX_532de2437e9df87a4922597df0"`)
        await db.query(`DROP TABLE "profile_image_update"`)
        await db.query(`DROP INDEX "public"."IDX_3b7c467f695dc8f3ec760ee85e"`)
        await db.query(`DROP INDEX "public"."IDX_219c6c21f1a76f819363387882"`)
        await db.query(`DROP INDEX "public"."IDX_0b771344d869d543e7bb75d945"`)
        await db.query(`ALTER TABLE "mirror" DROP CONSTRAINT "FK_bd7df2937349fcbce9ec792ada1"`)
        await db.query(`ALTER TABLE "mirror" DROP CONSTRAINT "FK_e4d9ffc54c3594135f98ee4c19d"`)
        await db.query(`ALTER TABLE "comment" DROP CONSTRAINT "FK_1d9ca0edf55bf20f432c833f056"`)
        await db.query(`ALTER TABLE "comment" DROP CONSTRAINT "FK_c347365e78bd7ea7084bb871d1f"`)
        await db.query(`ALTER TABLE "collect" DROP CONSTRAINT "FK_085b3bf104033de7d1471f1f4f5"`)
        await db.query(`ALTER TABLE "collect" DROP CONSTRAINT "FK_52faaf00229800a6a8aafe4fa1a"`)
        await db.query(`ALTER TABLE "collect" DROP CONSTRAINT "FK_dc6686a309914a5b8da07752e1f"`)
        await db.query(`ALTER TABLE "collect" DROP CONSTRAINT "FK_f538104b0af9bf33281844848a1"`)
        await db.query(`ALTER TABLE "collect" DROP CONSTRAINT "FK_21897f95882fddfc8b58321f99b"`)
        await db.query(`ALTER TABLE "publication_ref" DROP CONSTRAINT "FK_adeed6d2bc6d6c6b21571cc43af"`)
        await db.query(`ALTER TABLE "publication_ref" DROP CONSTRAINT "FK_baab7ed927f6da2aec78efaacf8"`)
        await db.query(`ALTER TABLE "publication_ref" DROP CONSTRAINT "FK_a3f289268936a82b5754ff8c5db"`)
        await db.query(`ALTER TABLE "publication_ref" DROP CONSTRAINT "FK_855d700f25c5a1da322a4d18b07"`)
        await db.query(`ALTER TABLE "profile_transfer" DROP CONSTRAINT "FK_30baa7f52c2e661f4ca493ab45e"`)
        await db.query(`ALTER TABLE "profile_image_update" DROP CONSTRAINT "FK_3b7c467f695dc8f3ec760ee85e9"`)
    }
}
